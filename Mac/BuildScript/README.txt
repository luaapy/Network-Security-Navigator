NSN macOS Installer Build Script
=================================

This directory contains the helper script **`build-installer.py`** used to create a signed macOS installer (DMG) for the NSN interpreter.

## Prerequisites
- macOS 10.12 or newer
- Xcode command‑line tools (`xcode-select --install`)
- CMake (installed via Homebrew: `brew install cmake`)
- Python 3 (the script uses only the standard library)
- An Apple Developer account if you want to notarize the installer (optional)

## Usage
```bash
cd path/to/nsn/Mac/BuildScript
python3 build-installer.py
```
The script performs the following steps automatically:
1. **Build** the NSN interpreter as a universal binary (x86_64 + arm64) using CMake.
2. **Create** an `.app` bundle (`NSN.app`) with a minimal `Info.plist`.
3. **Code‑sign** the bundle.  By default it uses an ad‑hoc signature (`-`).
   To use a real developer identity set the environment variable:
   ```bash
   export CODE_SIGN_IDENTITY="Developer ID Application: Your Name (TEAMID)"
   ```
4. **Package** the bundle into a compressed DMG (`NSN.dmg`).
5. **Notarize** (optional).  Set the following environment variables to enable notarization:
   ```bash
   export APPLE_NOTARIZE=1
   export APPLE_NOTARIZE_USER="your@appleid.com"
   export APPLE_NOTARIZE_PASS="app‑specific‑password"
   ```
   The script will upload the DMG to Apple’s notarization service and report the submission status.

## Output
- `build/NSN.app` – the signed application bundle.
- `build/NSN.dmg` – the final installer image ready for distribution.

## Customisation
- **Background image** – place a PNG named `dmg_background.png` in `Mac/Resources/` and it will be copied into the bundle for a custom DMG appearance.
- **Version** – modify the `CFBundleVersion` field in the `Info.plist` section of `build-installer.py` to match your release version.

## Troubleshooting
- If CMake cannot find a compiler, ensure Xcode command‑line tools are installed.
- Code‑signing failures usually stem from an incorrect or missing `CODE_SIGN_IDENTITY`. Verify the identity with `security find-identity -v -p codesigning`.
- Notarization errors will be printed to the console; check the Apple Developer portal for detailed logs.

---
Generated by the NSN development tooling.
